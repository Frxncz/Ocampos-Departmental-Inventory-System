<!DOCTYPE html>
<html>
<head>
  <base target="_top" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <?!= include("Styles"); ?>
</head>

<body>
  <div class="shell">
    <div class="panel">
      <div class="header">
        <div class="logoWrapper">
          <img src="https://i.imgur.com/6tgDsdR.png" class="mainLogo" alt="Ocampos Logo">
        </div>
        <h1 class="title">Ocampo's Warehouse Department Catalog</h1>
        <p class="sub">Select a department to manage inventory</p>
      </div>

      <div class="content">
        <div class="contentInner">

          <!-- Department selector -->
          <div id="viewDepartments">
            <div id="deptLoading" class="loadingBox">
              <div class="spinner"></div>
              Loading departments...
            </div>
            <div class="deptGrid" id="deptGrid" style="display:none;"></div>
          </div>

          <!-- Inventory -->
          <div id="viewInventory" style="display:none;">
            <div class="topBar">
              <div class="crumb">
                <h3 id="deptTitle">Department</h3>
                <p>Type in the search bar to quickly find items.</p>
              </div>
              <div class="actionsTop">
                <button class="primaryTop" onclick="openAdd()">+ Add Item</button>
                <button class="backBtn" onclick="goBack()">← Back</button>
              </div>
            </div>

            <!-- SEARCH BAR -->
            <div class="searchRow">
              <input id="searchInput" class="searchInput" type="text"
                     placeholder="Search item code, name, category..."
                     oninput="applySearch()" />
              <button class="clearBtn" onclick="clearSearch()">Clear</button>
            </div>

            <!-- ITEMS LOADING -->
            <div id="itemsLoading" class="loadingBox" style="display:none;">
              <div class="spinner"></div>
              Loading items...
            </div>

            <div id="tableWrap">
              <table>
                <thead>
                  <tr>
                    <th>Item Code</th>
                    <th>Item Name</th>
                    <th>Category</th>
                    <th>Qty</th>
                    <th>Image</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody id="invBody"></tbody>
              </table>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>

  <!-- EDIT MODAL -->
  <div class="overlay" id="editOverlay">
    <div class="modal">
      <h3>Edit Item</h3>
      <div class="formGrid">
        <input id="e_code" placeholder="Item Code (read-only)" disabled />
        <input id="e_name" placeholder="Item Name" />
        <input id="e_category" placeholder="Category" />
        <input id="e_qty" type="number" placeholder="Quantity" />
        <input id="e_image" placeholder="Image URL (direct public link)" />
      </div>
      <p class="hint">Item code is auto-generated. To remove image: click “Remove Image”.</p>
      <div class="modalRow">
        <button class="actBtn ghost" onclick="closeEdit()">Cancel</button>
        <button class="actBtn danger" onclick="removeImageEdit()">Remove Image</button>
        <button class="actBtn primary" onclick="saveEdit()">Save</button>
      </div>
    </div>
  </div>

  <!-- ADD MODAL (AUTO CODE, NO STATUS/UNIT) -->
  <div class="overlay" id="addOverlay">
    <div class="modal">
      <h3>Add Item</h3>
      <div class="formGrid">
        <input id="a_name" placeholder="Item Name" />
        <input id="a_category" placeholder="Category" />
        <input id="a_qty" type="number" placeholder="Quantity" />
        <input id="a_image" placeholder="Image URL (direct public link)" />
      </div>
      <p class="hint">Item code is auto-generated. Status & Unit hidden in UI.</p>
      <div class="modalRow">
        <button class="actBtn ghost" onclick="closeAdd()">Cancel</button>
        <button class="actBtn primary" onclick="saveAdd()">Add</button>
      </div>
    </div>
  </div>

  <?!= include("Scripts"); ?>
</body>
</html>
